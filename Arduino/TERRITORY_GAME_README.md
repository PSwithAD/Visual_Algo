# 땅따먹기 게임 (Territory Conquest Game)

16x16 LED 매트릭스 위에서 6x6 그리드(36개 노드)를 사용하는 2인 대전 전략 게임입니다.

## 파일 구조

```
ino_code/
├── territory_game.cpp          # 메인 게임 로직
├── input_interface.h           # 입력 인터페이스 헤더
├── input_interface.cpp         # 입력 인터페이스 구현
└── territory_game_rules.md     # 게임 규칙 상세 문서
```

## 하드웨어 구성

### LED 매트릭스
- **LED 핀**: A2
- **LED 개수**: 256 (16x16)
- **밝기**: 15 (기본값)

### 자석 모듈 입력 (6x6 그리드)
아두이노 핀 12개를 사용하여 6x6 매트릭스를 스캔합니다.

#### Row 출력 핀 (6개)
- 핀 13, 12, 11, 10, 9, 8
- OUTPUT 모드
- 기본값: HIGH

#### Column 입력 핀 (6개)
- 핀 7, 6, 5, 4, 3, 2
- INPUT_PULLUP 모드
- 자석 접촉 시: LOW

### 동작 원리
1. 각 행(Row)을 순차적으로 LOW로 활성화
2. 모든 열(Column)을 읽어서 LOW인 핀 확인
3. Row와 Column 조합으로 노드 번호 (0~35) 결정
4. 디바운싱: 200ms 간격으로 입력 인식

## 컴파일 방법

### PC 테스트 (시리얼 입력)
```bash
cd ino_code
g++ -std=c++17 -DTARGET_PC territory_game.cpp -o territory_game
./territory_game
```

### Arduino 업로드
Arduino IDE에서:
1. `territory_game.cpp`를 `.ino`로 복사
2. `input_interface.h`와 `input_interface.cpp`를 같은 폴더에 배치
3. Adafruit_NeoPixel 라이브러리 설치
4. 보드 선택 및 업로드

## 게임 방법

### 시작 위치
- **Player 1 (초록색)**: 노드 0 (좌측 상단)
- **Player 2 (파란색)**: 노드 35 (우측 하단)

### 노드 번호 맵
```
 0  1  2  3  4  5
 6  7  8  9 10 11
12 13 14 15 16 17
18 19 20 21 22 23
24 25 26 27 28 29
30 31 32 33 34 35
```

### 입력 방법

#### PC 테스트
표준 입력으로 노드 번호 입력:
```
1    # Player 1이 노드 1로 이동
30   # Player 2가 노드 30으로 이동
2    # Player 1이 노드 2로 이동
```

#### Arduino (자석 모듈)
- 6x6 빵판에 자석 모듈 배치
- 자석을 원하는 위치에 대면 자동으로 입력

### 이동 규칙
- 한 턴에 **상하좌우 1칸**만 이동 가능
- 대각선 이동 불가
- 현재 위치에서 인접한 노드로만 이동 가능

### 점령 규칙
- **임시 점령** (연한 색): 처음 방문한 중립 노드
- **확정 점령** (진한 색):
  - 자신의 임시 노드를 다시 선택
  - 상대의 임시 노드에 도착

### 제약 조건
- 같은 노드를 연속 2턴 선택 불가
- 확정 노드가 0개일 때는 반드시 새 노드로 이동

### 승리 조건 (우선순위 순)

1. **상대 고립**: 상대가 새로운 중립 노드로 이동할 수 없는 경우
2. **과반수 점령**: 임시 + 확정 노드 합쳐서 19개 이상
3. **100턴 도달**:
   - 1차: 임시 + 확정 노드가 더 많은 플레이어
   - 2차: 확정 노드가 더 많은 플레이어
   - 3차: 무승부

## LED 색상 코드

### 노드 상태
- **중립**: `(100, 100, 100)` - 회색 1픽셀
- **P1 임시**: `(100, 255, 100)` - 연한 초록 1픽셀
- **P1 확정**: `(0, 255, 0)` - 진한 초록 3x3픽셀
- **P2 임시**: `(100, 100, 255)` - 연한 파란 1픽셀
- **P2 확정**: `(0, 0, 255)` - 진한 파란 3x3픽셀

### 특수 상태
- **현재 위치**: 5x5 흰색 테두리 박스
- **잘못된 선택**: `(255, 0, 0)` - 빨간색 0.5초 깜빡임
- **승리**: 노란색 테두리 + 전체 승자 색상 2초 표시

## 시각화

### Python 애니메이션 (PC 테스트용)
```bash
# 먼저 게임 실행
./territory_game

# 별도 터미널에서 시각화 실행
python3 run_animation.py
```

`run_animation.py`에서 실행 파일 경로 설정:
```python
CPP_EXCUTABLE = "./ino_code/territory_game"
```

## 전략 팁

### 공격적 전략
- 빠르게 영역을 넓혀 상대의 확장 저지
- 상대의 임시 노드를 적극적으로 빼앗기

### 수비적 전략
- 확정 노드를 먼저 확보하여 안정적인 기반 구축
- 중앙 지역 선점

### 균형 전략
- 전진 2회 → 확정 1회의 패턴 유지
- 상대 움직임을 보고 대응

## 트러블슈팅

### 컴파일 에러
- `Adafruit_NeoPixel.h` 없음: 라이브러리 설치 필요
- 중복 심볼 에러: PC 빌드 시 `input_interface.cpp` 제외

### 입력 인식 안됨
- 자석 모듈 연결 확인 (핀 2-7, 8-13)
- INPUT_PULLUP 설정 확인
- 디바운싱 시간(200ms) 대기

### LED 표시 안됨
- LED 핀 연결 확인 (A2)
- 밝기 설정 확인 (기본값 15)
- NeoPixel 전원 확인

## 개발자 정보

### 디버그 출력
게임은 시리얼 통신(115200 baud)으로 상태를 출력합니다:
- 턴 정보
- 선택한 노드
- 점령 상태
- 승리 조건

### 프레임 형식
```
FRAME:번호
[16x16 RGB 헥스 값]
---
```

## 라이선스

이 프로젝트는 교육 목적으로 제작되었습니다.
